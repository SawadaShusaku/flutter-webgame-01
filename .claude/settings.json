{
  "allowedCommands": [
    "flutter",
    "dart",
    "git",
    "tmux",
    "ls",
    "cat",
    "mkdir",
    "rm",
    "cp",
    "mv",
    "touch",
    "echo",
    "pwd",
    "cd",
    "grep",
    "find",
    "chmod",
    "chown",
    "npm",
    "yarn",
    "node",
    "python",
    "python3",
    "pip",
    "pip3",
    "curl",
    "wget",
    "tar",
    "unzip",
    "zip",
    "which",
    "whereis",
    "head",
    "tail",
    "less",
    "more",
    "diff",
    "patch",
    "sed",
    "awk",
    "sort",
    "uniq",
    "wc",
    "file",
    "tree",
    "du",
    "df",
    "ps",
    "kill",
    "killall",
    "sleep",
    "date",
    "time",
    "watch",
    "adb",
    "fastlane",
    "bundle",
    "ruby",
    "gem"
  ],

  "project": {
    "name": "Catan Board Game",
    "type": "flutter-web-game",
    "mainLanguage": "dart"
  },

  "development": {
    "parallelAgents": 5,
    "worktreePrefix": "worktree-agent",
    "branchPrefix": "feature/agent",
    "workingDirectory": "/root/test_web_app"
  },

  "tmux": {
    "sessionName": "0",
    "note": "重要: 既存のセッション「0」を使用。新しいセッションは作成しない！",
    "paneCount": 5,
    "paneAssignments": {
      "0": "main (Pane 0 - メインの統合作業用)",
      "1": "services (Pane 1 - /root/worktrees/services)",
      "2": "ui-screens (Pane 2 - /root/worktrees/ui-screens)",
      "3": "ui-widgets (Pane 3 - /root/worktrees/ui-widgets)",
      "4": "integration (Pane 4 - /root/worktrees/integration)"
    },
    "commandSendingMethod": {
      "script": "/tmp/send_command.sh",
      "format": "/tmp/send_command.sh 0:0.{pane_number} \"command\"",
      "example": "/tmp/send_command.sh 0:0.1 \"claude TASK.md\"",
      "warning": "セッション名は必ず「0」を使用。catan-devなど別のセッションを作成してはいけない",
      "importantNote": "コマンド送信時は必ず2回Enterを押す必要がある",
      "correctUsage": [
        "tmux send-keys -t 0:0.1 \"claude TASK.md\" Enter",
        "tmux send-keys -t 0:0.1 \"\" Enter  # 2回目のEnterが必須！"
      ],
      "reason": "PRoot環境の特性により、1回目のEnterだけでは実行されない"
    }
  },

  "git": {
    "mainBranch": "main",
    "developBranch": "develop",
    "commitMessagePrefix": true,
    "autoSync": false,
    "conflictStrategy": "manual-review"
  },

  "flutter": {
    "webRenderer": "canvaskit",
    "buildMode": "debug",
    "hotReload": true,
    "codingStandards": {
      "importStyle": {
        "rule": "ALWAYS use package imports (absolute paths)",
        "enforcement": "CRITICAL",
        "reason": "Package imports stick when rearranging files/folders, while relative imports break easily",
        "correctFormat": "import 'package:test_web_app/models/game_state.dart';",
        "incorrectFormats": [
          "import '../models/game_state.dart';",
          "import '../../models/game_state.dart';",
          "import '../../../models/game_state.dart';"
        ],
        "linterRule": "always_use_package_imports",
        "rationale": "2025 Flutter best practice: Package imports are more maintainable for medium/large projects"
      },
      "projectStructure": {
        "architecture": "Feature-First",
        "reason": "Recommended for large projects - scales well and organizes files by feature",
        "structure": {
          "lib/": {
            "models/": "Data models and enums",
            "services/": "Business logic and state management",
            "ui/": {
              "screens/": "Full-page screens",
              "widgets/": "Reusable UI components (organized by feature)",
              "painters/": "Custom painters for canvas drawing"
            },
            "utils/": "Utility functions and constants",
            "main.dart": "Application entry point"
          }
        },
        "namingConventions": {
          "files": "snake_case (e.g., game_controller.dart)",
          "classes": "PascalCase (e.g., GameController)",
          "variables": "camelCase (e.g., currentPlayer)",
          "constants": "camelCase with const (e.g., const maxPlayers = 4)"
        }
      },
      "fileOrganization": {
        "importOrder": [
          "1. Dart SDK imports",
          "2. Flutter SDK imports",
          "3. Third-party package imports",
          "4. Project package imports (always use package: syntax)"
        ],
        "barrelFiles": {
          "usage": "Optional - use index.dart or feature.dart to simplify imports",
          "example": "lib/models/index.dart can export all model files"
        }
      },
      "commonPitfalls": {
        "avoidRelativeLibImports": {
          "rule": "NEVER use relative imports from lib/",
          "bad": "import '../../../models/game_state.dart';",
          "good": "import 'package:test_web_app/models/game_state.dart';",
          "consequence": "Relative paths break when files are moved/reorganized"
        },
        "avoidOldPaths": {
          "rule": "Always update imports when moving/renaming files",
          "examples": [
            "controllers/ → services/ (update all references)",
            "widgets/ → widgets/board/ (update import paths)"
          ]
        },
        "deleteUnusedFiles": {
          "rule": "Delete old files immediately after moving/refactoring",
          "reason": "Prevents accidental imports of outdated code"
        }
      },
      "verificationSteps": {
        "beforeCommit": [
          "1. Search for relative imports: grep -r \"import '../\" lib/",
          "2. Search for old paths: grep -r \"controllers/\" lib/",
          "3. Verify no duplicate files exist",
          "4. Run flutter analyze to check for errors"
        ],
        "beforePush": [
          "1. Ensure all import paths use package: syntax",
          "2. Verify all files compile without errors",
          "3. Check GitHub Actions will pass (if possible locally)"
        ]
      }
    }
  },

  "permissions": {
    "autoApprove": {
      "tools": ["Task"],
      "note": "Taskツール（エージェント起動）を自動承認して効率化"
    }
  },

  "communication": {
    "progressReportFormat": "[AGENT-{id}] {status}: {message}",
    "errorReportFormat": "[AGENT-{id}] ERROR: {error}",
    "completionFormat": "[AGENT-{id}] DONE: {task}"
  },

  "fileWatching": {
    "watchPaths": [
      "lib/**/*.dart",
      "pubspec.yaml",
      "docs/**/*.md"
    ],
    "ignorePatterns": [
      "build/",
      ".dart_tool/",
      "*.g.dart"
    ]
  },

  "developmentEnvironment": {
    "note": "重要: ローカルFlutter SDKはPRoot環境で正常に動作しない（ELFヘッダーエラー）",
    "claudeCodeStartup": {
      "requiredFlags": ["--dangerously-skip-permission"],
      "reason": "ツール使用時の許可確認を省略して効率的に開発"
    },
    "localFlutterSDK": {
      "status": "broken",
      "issue": "invalid ELF header in PRoot Ubuntu environment",
      "workaround": "GitHub Actionsを使用してビルド"
    },
    "developmentWorkflow": {
      "description": "GitHub Actionsベースの開発フロー",
      "steps": [
        "1. コードをローカルで編集",
        "2. GitHubにpush",
        "3. GitHub Actionsが自動で2つのAPKをビルド",
        "4. Actionsページからビルド済みAPKをダウンロード",
        "5. Androidデバイスにインストールして動作確認"
      ],
      "githubActions": {
        "workflowFile": ".github/workflows/build-android.yml",
        "triggers": [
          "push to main branch",
          "pull_request to main",
          "manual workflow_dispatch"
        ],
        "artifacts": [
          {
            "name": "space-invaders-game-apk",
            "description": "ゲーム本体のAPK",
            "path": "build/app/outputs/flutter-apk/app-debug.apk"
          },
          {
            "name": "space-invaders-widgetbook-apk",
            "description": "Widgetbook開発ツールのAPK",
            "path": "build/app/outputs/flutter-apk/app-debug.apk"
          }
        ],
        "retentionDays": 30
      }
    },
    "currentProject": {
      "documentation": "カタン風ボードゲームの詳細な開発計画 (docs/catan-game-plan.md)",
      "actualImplementation": "Space Invadersゲーム (lib/main.dart)",
      "note": "ドキュメントと実装が異なるプロジェクトを指している"
    }
  }
}
